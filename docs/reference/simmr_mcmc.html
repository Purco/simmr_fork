<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Run a simmr_input object through the main simmr Markov chain Monte
Carlo (MCMC) function — simmr_mcmc • simmr</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Run a simmr_input object through the main simmr Markov chain Monte
Carlo (MCMC) function — simmr_mcmc" />
<meta property="og:description" content="This is the main function of simmr. It takes a simmr_input object
created via simmr_load, runs an MCMC to determine the dietary
proportions, and then outputs a simmr_output object for further
analysis and plotting via summary.simmr_output and
plot.simmr_output." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">simmr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.4.6.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/simmr.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/advanced_plotting.html">simmr: advanced plotting guide</a>
    </li>
    <li>
      <a href="../articles/quick_start.html">simmr: quick start guide</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/andrewcparnell/simmr/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Run a <code>simmr_input</code> object through the main simmr Markov chain Monte
Carlo (MCMC) function</h1>
    <small class="dont-index">Source: <a href='https://github.com/andrewcparnell/simmr/blob/master/R/simmr_mcmc.R'><code>R/simmr_mcmc.R</code></a></small>
    <div class="hidden name"><code>simmr_mcmc.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This is the main function of simmr. It takes a <code>simmr_input</code> object
created via <code><a href='simmr_load.html'>simmr_load</a></code>, runs an MCMC to determine the dietary
proportions, and then outputs a <code>simmr_output</code> object for further
analysis and plotting via <code><a href='summary.simmr_output.html'>summary.simmr_output</a></code> and
<code><a href='plot.simmr_output.html'>plot.simmr_output</a></code>.</p>
    </div>

    <pre class="usage"><span class='fu'>simmr_mcmc</span><span class='op'>(</span>
  <span class='va'>simmr_in</span>,
  prior_control <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>means <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='va'>simmr_in</span><span class='op'>$</span><span class='va'>n_sources</span><span class='op'>)</span>, sd <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>1</span>,
    <span class='va'>simmr_in</span><span class='op'>$</span><span class='va'>n_sources</span><span class='op'>)</span><span class='op'>)</span>,
  mcmc_control <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>iter <span class='op'>=</span> <span class='fl'>10000</span>, burn <span class='op'>=</span> <span class='fl'>1000</span>, thin <span class='op'>=</span> <span class='fl'>10</span>, n.chain <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>simmr_in</th>
      <td><p>An object created via the function <code><a href='simmr_load.html'>simmr_load</a></code></p></td>
    </tr>
    <tr>
      <th>prior_control</th>
      <td><p>A list of values including arguments named <code>means</code>
and <code>sd</code> which represent the prior means and standard deviations of the
dietary proportions in centralised log-ratio space. These can usually be
left at their default values unless you wish to include to include prior
information, in which case you should use the function
<code><a href='simmr_elicit.html'>simmr_elicit</a></code>.</p></td>
    </tr>
    <tr>
      <th>mcmc_control</th>
      <td><p>A list of values including arguments named <code>iter</code>
(number of iterations), <code>burn</code> (size of burn-in), <code>thin</code> (amount
of thinning), and <code>n.chain</code> (number of MCMC chains).</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An object of class <code>simmr_output</code> with two named top-level
components:</p>
<dt>input </dt><dd><p>The <code>simmr_input</code> object given to the
<code>simmr_mcmc</code> function</p></dd> <dt>output </dt><dd><p>A set of MCMC chains of class
<code>mcmc.list</code> from the coda package. These can be analysed using the
<code><a href='summary.simmr_output.html'>summary.simmr_output</a></code> and <code><a href='plot.simmr_output.html'>plot.simmr_output</a></code>
functions.</p></dd>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>If, after running <code>simmr_mcmc</code> the convergence diagnostics in
<code><a href='summary.simmr_output.html'>summary.simmr_output</a></code> are not satisfactory, the values of
<code>iter</code>, <code>burn</code> and <code>thin</code> in <code>mcmc_control</code> should be
increased by a factor of 10.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Andrew C. Parnell, Donald L. Phillips, Stuart Bearhop, Brice X.
Semmens, Eric J. Ward, Jonathan W. Moore, Andrew L. Jackson, Jonathan Grey,
David J. Kelly, and Richard Inger. Bayesian stable isotope mixing models.
Environmetrics, 24(6):387–399, 2013.</p>
<p>Andrew C Parnell, Richard Inger, Stuart Bearhop, and Andrew L Jackson.
Source partitioning using stable isotopes: coping with too much variation.
PLoS ONE, 5(3):5, 2010.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='simmr_load.html'>simmr_load</a></code> for creating objects suitable for this
function, <code><a href='plot.simmr_input.html'>plot.simmr_input</a></code> for creating isospace plots,
<code><a href='summary.simmr_output.html'>summary.simmr_output</a></code> for summarising output, and
<code><a href='plot.simmr_output.html'>plot.simmr_output</a></code> for plotting output.</p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Andrew Parnell &lt;andrew.parnell@mu.ie&gt;</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
<span class='co'>## See the package vignette for a detailed run through of these 4 examples</span>

<span class='co'># Data set 1: 10 obs on 2 isos, 4 sources, with tefs and concdep</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>geese_data_day1</span><span class='op'>)</span>
<span class='va'>simmr_1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/with.html'>with</a></span><span class='op'>(</span>
  <span class='va'>geese_data_day1</span>,
  <span class='fu'><a href='simmr_load.html'>simmr_load</a></span><span class='op'>(</span>
    mixtures <span class='op'>=</span> <span class='va'>mixtures</span>,
    source_names <span class='op'>=</span> <span class='va'>source_names</span>,
    source_means <span class='op'>=</span> <span class='va'>source_means</span>,
    source_sds <span class='op'>=</span> <span class='va'>source_sds</span>,
    correction_means <span class='op'>=</span> <span class='va'>correction_means</span>,
    correction_sds <span class='op'>=</span> <span class='va'>correction_sds</span>,
    concentration_means <span class='op'>=</span> <span class='va'>concentration_means</span>
  <span class='op'>)</span>
<span class='op'>)</span>

<span class='co'># Plot</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>simmr_1</span><span class='op'>)</span>

<span class='co'># Print</span>
<span class='va'>simmr_1</span>

<span class='co'># MCMC run</span>
<span class='va'>simmr_1_out</span> <span class='op'>&lt;-</span> <span class='fu'>simmr_mcmc</span><span class='op'>(</span><span class='va'>simmr_1</span><span class='op'>)</span>

<span class='co'># Print it</span>
<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='va'>simmr_1_out</span><span class='op'>)</span>

<span class='co'># Summary</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>simmr_1_out</span>, type <span class='op'>=</span> <span class='st'>"diagnostics"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>simmr_1_out</span>, type <span class='op'>=</span> <span class='st'>"correlations"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>simmr_1_out</span>, type <span class='op'>=</span> <span class='st'>"statistics"</span><span class='op'>)</span>
<span class='va'>ans</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>simmr_1_out</span>, type <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"quantiles"</span>, <span class='st'>"statistics"</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'># Plot</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>simmr_1_out</span>, type <span class='op'>=</span> <span class='st'>"boxplot"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>simmr_1_out</span>, type <span class='op'>=</span> <span class='st'>"histogram"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>simmr_1_out</span>, type <span class='op'>=</span> <span class='st'>"density"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>simmr_1_out</span>, type <span class='op'>=</span> <span class='st'>"matrix"</span><span class='op'>)</span>

<span class='co'># Compare two sources</span>
<span class='fu'><a href='compare_sources.html'>compare_sources</a></span><span class='op'>(</span><span class='va'>simmr_1_out</span>, source_names <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Zostera"</span>, <span class='st'>"Enteromorpha"</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'># Compare multiple sources</span>
<span class='fu'><a href='compare_sources.html'>compare_sources</a></span><span class='op'>(</span><span class='va'>simmr_1_out</span><span class='op'>)</span>

<span class='co'>#####################################################################################</span>

<span class='co'># A version with just one observation</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>geese_data_day1</span><span class='op'>)</span>
<span class='va'>simmr_2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/with.html'>with</a></span><span class='op'>(</span>
  <span class='va'>geese_data_day1</span>,
  <span class='fu'><a href='simmr_load.html'>simmr_load</a></span><span class='op'>(</span>
    mixtures <span class='op'>=</span> <span class='va'>mixtures</span><span class='op'>[</span><span class='fl'>1</span>, , drop <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>]</span>,
    source_names <span class='op'>=</span> <span class='va'>source_names</span>,
    source_means <span class='op'>=</span> <span class='va'>source_means</span>,
    source_sds <span class='op'>=</span> <span class='va'>source_sds</span>,
    correction_means <span class='op'>=</span> <span class='va'>correction_means</span>,
    correction_sds <span class='op'>=</span> <span class='va'>correction_sds</span>,
    concentration_means <span class='op'>=</span> <span class='va'>concentration_means</span>
  <span class='op'>)</span>
<span class='op'>)</span>

<span class='co'># Plot</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>simmr_2</span><span class='op'>)</span>

<span class='co'># MCMC run - automatically detects the single observation</span>
<span class='va'>simmr_2_out</span> <span class='op'>&lt;-</span> <span class='fu'>simmr_mcmc</span><span class='op'>(</span><span class='va'>simmr_2</span><span class='op'>)</span>

<span class='co'># Print it</span>
<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='va'>simmr_2_out</span><span class='op'>)</span>

<span class='co'># Summary</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>simmr_2_out</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>simmr_2_out</span>, type <span class='op'>=</span> <span class='st'>"diagnostics"</span><span class='op'>)</span>
<span class='va'>ans</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>simmr_2_out</span>, type <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"quantiles"</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'># Plot</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>simmr_2_out</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>simmr_2_out</span>, type <span class='op'>=</span> <span class='st'>"boxplot"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>simmr_2_out</span>, type <span class='op'>=</span> <span class='st'>"histogram"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>simmr_2_out</span>, type <span class='op'>=</span> <span class='st'>"density"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>simmr_2_out</span>, type <span class='op'>=</span> <span class='st'>"matrix"</span><span class='op'>)</span>

<span class='co'>#####################################################################################</span>

<span class='co'># Data set 2: 3 isotopes (d13C, d15N and d34S), 30 observations, 4 sources</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>simmr_data_2</span><span class='op'>)</span>
<span class='va'>simmr_3</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/with.html'>with</a></span><span class='op'>(</span>
  <span class='va'>simmr_data_2</span>,
  <span class='fu'><a href='simmr_load.html'>simmr_load</a></span><span class='op'>(</span>
    mixtures <span class='op'>=</span> <span class='va'>mixtures</span>,
    source_names <span class='op'>=</span> <span class='va'>source_names</span>,
    source_means <span class='op'>=</span> <span class='va'>source_means</span>,
    source_sds <span class='op'>=</span> <span class='va'>source_sds</span>,
    correction_means <span class='op'>=</span> <span class='va'>correction_means</span>,
    correction_sds <span class='op'>=</span> <span class='va'>correction_sds</span>,
    concentration_means <span class='op'>=</span> <span class='va'>concentration_means</span>
  <span class='op'>)</span>
<span class='op'>)</span>

<span class='co'># Get summary</span>
<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='va'>simmr_3</span><span class='op'>)</span>

<span class='co'># Plot 3 times</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>simmr_3</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>simmr_3</span>, tracers <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2</span>, <span class='fl'>3</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>simmr_3</span>, tracers <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>3</span><span class='op'>)</span><span class='op'>)</span>
<span class='co'># See vignette('simmr') for fancier axis labels</span>

<span class='co'># MCMC run</span>
<span class='va'>simmr_3_out</span> <span class='op'>&lt;-</span> <span class='fu'>simmr_mcmc</span><span class='op'>(</span><span class='va'>simmr_3</span><span class='op'>)</span>

<span class='co'># Print it</span>
<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='va'>simmr_3_out</span><span class='op'>)</span>

<span class='co'># Summary</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>simmr_3_out</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>simmr_3_out</span>, type <span class='op'>=</span> <span class='st'>"diagnostics"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>simmr_3_out</span>, type <span class='op'>=</span> <span class='st'>"quantiles"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>simmr_3_out</span>, type <span class='op'>=</span> <span class='st'>"correlations"</span><span class='op'>)</span>

<span class='co'># Plot</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>simmr_3_out</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>simmr_3_out</span>, type <span class='op'>=</span> <span class='st'>"boxplot"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>simmr_3_out</span>, type <span class='op'>=</span> <span class='st'>"histogram"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>simmr_3_out</span>, type <span class='op'>=</span> <span class='st'>"density"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>simmr_3_out</span>, type <span class='op'>=</span> <span class='st'>"matrix"</span><span class='op'>)</span>

<span class='co'>#####################################################################################</span>

<span class='co'># Data set 4 - identified by Fry (2014) as a failing of SIMMs</span>
<span class='co'># See the vignette for more interpreation of these data and the output</span>

<span class='co'># The data</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>square_data</span><span class='op'>)</span>
<span class='va'>simmr_4</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/with.html'>with</a></span><span class='op'>(</span>
  <span class='va'>square_data</span>,
  <span class='fu'><a href='simmr_load.html'>simmr_load</a></span><span class='op'>(</span>
    mixtures <span class='op'>=</span> <span class='va'>mixtures</span>,
    source_names <span class='op'>=</span> <span class='va'>source_names</span>,
    source_means <span class='op'>=</span> <span class='va'>source_means</span>,
    source_sds <span class='op'>=</span> <span class='va'>source_sds</span>
  <span class='op'>)</span>
<span class='op'>)</span>

<span class='co'># Get summary</span>
<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='va'>simmr_4</span><span class='op'>)</span>

<span class='co'># Plot</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>simmr_4</span><span class='op'>)</span>

<span class='co'># MCMC run - needs slightly longer</span>
<span class='va'>simmr_4_out</span> <span class='op'>&lt;-</span> <span class='fu'>simmr_mcmc</span><span class='op'>(</span><span class='va'>simmr_4</span><span class='op'>)</span>

<span class='co'># Print it</span>
<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='va'>simmr_4_out</span><span class='op'>)</span>

<span class='co'># Summary</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>simmr_4_out</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>simmr_4_out</span>, type <span class='op'>=</span> <span class='st'>"diagnostics"</span><span class='op'>)</span>
<span class='va'>ans</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>simmr_4_out</span>, type <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"quantiles"</span>, <span class='st'>"statistics"</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'># Plot</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>simmr_4_out</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>simmr_4_out</span>, type <span class='op'>=</span> <span class='st'>"boxplot"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>simmr_4_out</span>, type <span class='op'>=</span> <span class='st'>"histogram"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>simmr_4_out</span>, type <span class='op'>=</span> <span class='st'>"density"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>simmr_4_out</span>, type <span class='op'>=</span> <span class='st'>"matrix"</span><span class='op'>)</span> <span class='co'># Look at the massive correlations here</span>

<span class='co'>#####################################################################################</span>

<span class='co'># Data set 5 - Multiple groups Geese data from Inger et al 2006</span>

<span class='co'># Do this in raw data format - Note that there's quite a few mixtures!</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>geese_data</span><span class='op'>)</span>
<span class='va'>simmr_5</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/with.html'>with</a></span><span class='op'>(</span>
  <span class='va'>geese_data</span>,
  <span class='fu'><a href='simmr_load.html'>simmr_load</a></span><span class='op'>(</span>
    mixtures <span class='op'>=</span> <span class='va'>mixtures</span>,
    source_names <span class='op'>=</span> <span class='va'>source_names</span>,
    source_means <span class='op'>=</span> <span class='va'>source_means</span>,
    source_sds <span class='op'>=</span> <span class='va'>source_sds</span>,
    correction_means <span class='op'>=</span> <span class='va'>correction_means</span>,
    correction_sds <span class='op'>=</span> <span class='va'>correction_sds</span>,
    concentration_means <span class='op'>=</span> <span class='va'>concentration_means</span>,
    group <span class='op'>=</span> <span class='va'>groups</span>
  <span class='op'>)</span>
<span class='op'>)</span>

<span class='co'># Plot</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>simmr_5</span>,
  xlab <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/expression.html'>expression</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='va'>delta</span><span class='op'>^</span><span class='fl'>13</span>, <span class='st'>"C (\\u2030)"</span>, sep <span class='op'>=</span> <span class='st'>""</span><span class='op'>)</span><span class='op'>)</span>,
  ylab <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/expression.html'>expression</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='va'>delta</span><span class='op'>^</span><span class='fl'>15</span>, <span class='st'>"N (\\u2030)"</span>, sep <span class='op'>=</span> <span class='st'>""</span><span class='op'>)</span><span class='op'>)</span>,
  title <span class='op'>=</span> <span class='st'>"Isospace plot of Inger et al Geese data"</span>
<span class='op'>)</span>

<span class='co'># Run MCMC for each group</span>
<span class='va'>simmr_5_out</span> <span class='op'>&lt;-</span> <span class='fu'>simmr_mcmc</span><span class='op'>(</span><span class='va'>simmr_5</span><span class='op'>)</span>

<span class='co'># Summarise output</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>simmr_5_out</span>, type <span class='op'>=</span> <span class='st'>"quantiles"</span>, group <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>simmr_5_out</span>, type <span class='op'>=</span> <span class='st'>"quantiles"</span>, group <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>3</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>simmr_5_out</span>, type <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"quantiles"</span>, <span class='st'>"statistics"</span><span class='op'>)</span>, group <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>3</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'># Plot - only a single group allowed</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>simmr_5_out</span>, type <span class='op'>=</span> <span class='st'>"boxplot"</span>, group <span class='op'>=</span> <span class='fl'>2</span>, title <span class='op'>=</span> <span class='st'>"simmr output group 2"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>simmr_5_out</span>, type <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"density"</span>, <span class='st'>"matrix"</span><span class='op'>)</span>, grp <span class='op'>=</span> <span class='fl'>6</span>, title <span class='op'>=</span> <span class='st'>"simmr output group 6"</span><span class='op'>)</span>

<span class='co'># Compare sources within a group</span>
<span class='fu'><a href='compare_sources.html'>compare_sources</a></span><span class='op'>(</span><span class='va'>simmr_5_out</span>, source_names <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Zostera"</span>, <span class='st'>"U.lactuca"</span><span class='op'>)</span>, group <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>
<span class='fu'><a href='compare_sources.html'>compare_sources</a></span><span class='op'>(</span><span class='va'>simmr_5_out</span>, group <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>

<span class='co'># Compare between groups</span>
<span class='fu'><a href='compare_groups.html'>compare_groups</a></span><span class='op'>(</span><span class='va'>simmr_5_out</span>, source <span class='op'>=</span> <span class='st'>"Zostera"</span>, groups <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>2</span><span class='op'>)</span>
<span class='fu'><a href='compare_groups.html'>compare_groups</a></span><span class='op'>(</span><span class='va'>simmr_5_out</span>, source <span class='op'>=</span> <span class='st'>"Zostera"</span>, groups <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>3</span><span class='op'>)</span>
<span class='fu'><a href='compare_groups.html'>compare_groups</a></span><span class='op'>(</span><span class='va'>simmr_5_out</span>, source <span class='op'>=</span> <span class='st'>"U.lactuca"</span>, groups <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>4</span><span class='op'>:</span><span class='fl'>5</span>, <span class='fl'>7</span>, <span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>
<span class='op'>}</span>

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Andrew Parnell.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


