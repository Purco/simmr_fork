<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Run a <code>simmr_input</code> object with multiple groups through a simmr Markov chain Monte
Carlo (MCMC) function with group as a random effect — simmr_mcmc_group_re • simmr</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Run a <code>simmr_input</code> object with multiple groups through a simmr Markov chain Monte
Carlo (MCMC) function with group as a random effect — simmr_mcmc_group_re" />
<meta property="og:description" content="This function allows multiple groups to be run through simmr with the group
variable treated as a random effect. It takes a simmr_input object
created via simmr_load, runs an MCMC to determine the 
proportions, and then outputs a simmr_output_re object for further
analysis and plotting via summary.simmr_output_re and
plot.simmr_output_re." />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">simmr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.4.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/simmr.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/quick_start.html">simmr: quick start guide</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Run a <code>simmr_input</code> object with multiple groups through a simmr Markov chain Monte
Carlo (MCMC) function with group as a random effect</h1>
    
    <div class="hidden name"><code>simmr_mcmc_group_re.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function allows multiple groups to be run through simmr with the group
variable treated as a random effect. It takes a <code>simmr_input</code> object
created via <code><a href='simmr_load.html'>simmr_load</a></code>, runs an MCMC to determine the 
proportions, and then outputs a <code>simmr_output_re</code> object for further
analysis and plotting via <code><a href='summary.simmr_output_re.html'>summary.simmr_output_re</a></code> and
<code><a href='plot.simmr_output_re.html'>plot.simmr_output_re</a></code>.</p>
    </div>

    <pre class="usage"><span class='fu'>simmr_mcmc_group_re</span>(
  <span class='no'>simmr_in</span>,
  <span class='kw'>source_control</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fl'>1</span>, <span class='kw'>nrow</span> <span class='kw'>=</span> <span class='no'>simmr_in</span>$<span class='no'>n_groups</span>, <span class='kw'>ncol</span> <span class='kw'>=</span> <span class='no'>simmr_in</span>$<span class='no'>n_sources</span>),
  <span class='kw'>scale_re</span> <span class='kw'>=</span> <span class='fl'>1</span>,
  <span class='kw'>mcmc_control</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>iter</span> <span class='kw'>=</span> <span class='fl'>10000</span>, <span class='kw'>burn</span> <span class='kw'>=</span> <span class='fl'>1000</span>, <span class='kw'>thin</span> <span class='kw'>=</span> <span class='fl'>10</span>, <span class='kw'>n.chain</span> <span class='kw'>=</span> <span class='fl'>4</span>)
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>simmr_in</th>
      <td><p>An object created via the function <code><a href='simmr_load.html'>simmr_load</a></code>.
This object must have multiple groups</p></td>
    </tr>
    <tr>
      <th>source_control</th>
      <td><p>A binary matrix which identifies which sources are to be 
included in which groups. The matrix should have the same number of rows 
as the number of groups, and the same number of columns as the total number of 
sources. If NULL (default) will assume all sources contribute to the mixture
for all groups</p></td>
    </tr>
    <tr>
      <th>scale_re</th>
      <td><p>The prior scale value of the Cauchy t-distributed 
random effect. For detailed prior control of individual groups use the main
<code><a href='simmr_mcmc.html'>simmr_mcmc</a></code> function.</p></td>
    </tr>
    <tr>
      <th>mcmc_control</th>
      <td><p>A list of values including arguments named <code>iter</code>
(number of iterations), <code>burn</code> (size of burn-in), <code>thin</code> (amount
of thinning), and <code>n.chain</code> (number of MCMC chains).</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An object of class <code>simmr_output_re</code> with two named top-level
components:</p>
<dt>input </dt><dd><p>The <code>simmr_input</code> object given to the
<code>simmr_mcmc</code> function</p></dd> <dt>output </dt><dd><p>A set of MCMC chains of class
<code>mcmc.list</code> from the coda package. These can be analysed using the
<code><a href='summary.simmr_output_re.html'>summary.simmr_output_re</a></code> and <code><a href='plot.simmr_output_re.html'>plot.simmr_output_re</a></code>
functions.</p></dd>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>If, after running <code>simmr_mcmc_group_re</code> the convergence diagnostics in
<code><a href='summary.simmr_output_re.html'>summary.simmr_output_re</a></code> are not satisfactory, the values of
<code>iter</code>, <code>burn</code> and <code>thin</code> in <code>mcmc_control</code> should be
increased by a factor of 10.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Andrew C. Parnell, Donald L. Phillips, Stuart Bearhop, Brice X.
Semmens, Eric J. Ward, Jonathan W. Moore, Andrew L. Jackson, Jonathan Grey,
David J. Kelly, and Richard Inger. Bayesian stable isotope mixing models.
Environmetrics, 24(6):387–399, 2013.</p>
<p>Andrew C Parnell, Richard Inger, Stuart Bearhop, and Andrew L Jackson.
Source partitioning using stable isotopes: coping with too much variation.
PLoS ONE, 5(3):5, 2010.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='simmr_load.html'>simmr_load</a></code> for creating objects suitable for this
function, <code><a href='plot.simmr_input.html'>plot.simmr_input</a></code> for creating isospace plots,
<code><a href='summary.simmr_output_re.html'>summary.simmr_output_re</a></code> for summarising output, and
<code><a href='plot.simmr_output_re.html'>plot.simmr_output_re</a></code> for plotting output. See 
<code><a href='simmr_mcmc.html'>simmr_mcmc</a></code> for the main <code>simmr</code> MCMC function which
does not borrow strength between groups and so runs them individually</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#details">Details</a></li>
      <li><a href="#references">References</a></li>
      <li><a href="#see-also">See also</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>Andrew Parnell &lt;andrew.parnell@mu.ie&gt;</p>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Andrew Parnell.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


