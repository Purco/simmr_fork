<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>simmr: advanced plotting guide • simmr</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="simmr: advanced plotting guide">
<meta property="og:description" content="simmr">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">simmr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.4.6.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/simmr.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/advanced_plotting.html">simmr: advanced plotting guide</a>
    </li>
    <li>
      <a href="../articles/quick_start.html">simmr: quick start guide</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/andrewcparnell/simmr/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="advanced_plotting_files/header-attrs-2.10/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>simmr: advanced plotting guide</h1>
                        <h4 class="author">Andrew Parnell</h4>
            
            <h4 class="date">2021-09-16</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/andrewcparnell/simmr/blob/master/vignettes/advanced_plotting.Rmd"><code>vignettes/advanced_plotting.Rmd</code></a></small>
      <div class="hidden name"><code>advanced_plotting.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p>Here I am assuming that you have installed simmr and loaded it with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"simmr"</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/andrewcparnell/simmr">simmr</a></span><span class="op">)</span></code></pre></div>
<p>In this vignette are some simple examples of how to customise plots in simmr which shouldn’t require large amounts of additional R knowledge. However…</p>
<p>To customise plots I would recommend having a basic understanding of the <code>ggplot2</code> package upon which all the simmr graphics are based. A good but long introduction to <code>ggplot2</code> can be found here: <a href="https://ggplot2-book.org" class="uri">https://ggplot2-book.org</a>. A short version including a cheat sheet is here: <a href="https://ggplot2.tidyverse.org" class="uri">https://ggplot2.tidyverse.org</a>. A script which runs through some simple ggplot2 examples is <a href="https://raw.githubusercontent.com/andrewcparnell/bhm_course/master/practicals/learn_ggplot2.R">here</a>.</p>
<p>In general, whilst it is possible to customise in a basic way things like axis limits and titles, very detailed customisation of plots is only possible by changing the underlying simmr code. There are different ways to do this, but perhaps the easiest is to download the relevant function from the <a href="https://github.com/andrewcparnell/simmr">simmr Github</a> page, and paste it into a new script file. Then you can edit this to produce the required picture.</p>
<p>If you have created other examples of extended simmr plots yourself, please <a href="https://github.com/andrewcparnell/simmr/issues">contact me</a> so I can include them here for other people to see.</p>
</div>
<div id="a-basic-simmr-run" class="section level2">
<h2 class="hasAnchor">
<a href="#a-basic-simmr-run" class="anchor"></a>A basic simmr run</h2>
<p>Consider a basic simmr run (see the other vignettes with <code>vignette(package = 'simmr')</code> for what the commands here mean):</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Load in example data</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">geese_data_day1</span><span class="op">)</span>
<span class="co"># Load into simmr</span>
<span class="va">simmr_in</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span>
  <span class="va">geese_data_day1</span>,
  <span class="fu"><a href="../reference/simmr_load.html">simmr_load</a></span><span class="op">(</span>
    mixtures <span class="op">=</span> <span class="va">mixtures</span>,
    source_names <span class="op">=</span> <span class="va">source_names</span>,
    source_means <span class="op">=</span> <span class="va">source_means</span>,
    source_sds <span class="op">=</span> <span class="va">source_sds</span>,
    correction_means <span class="op">=</span> <span class="va">correction_means</span>,
    correction_sds <span class="op">=</span> <span class="va">correction_sds</span>,
    concentration_means <span class="op">=</span> <span class="va">concentration_means</span>
  <span class="op">)</span>
<span class="op">)</span>
<span class="co"># MCMC run</span>
<span class="va">simmr_out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simmr_mcmc.html">simmr_mcmc</a></span><span class="op">(</span><span class="va">simmr_in</span><span class="op">)</span></code></pre></div>
</div>
<div id="customisation-of-iso-space-plots" class="section level2">
<h2 class="hasAnchor">
<a href="#customisation-of-iso-space-plots" class="anchor"></a>Customisation of iso-space plots</h2>
<p>The iso-space plots in simmr can be customised using arguments in the main body of the function see <code><a href="../reference/plot.simmr_input.html">help(plot.simmr_input)</a></code> for details. An example would be:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">simmr_in</span>,
  xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">delta</span><span class="op">^</span><span class="fl">13</span>, <span class="st">"C (\u2030)"</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span><span class="op">)</span>,
  ylab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">delta</span><span class="op">^</span><span class="fl">15</span>, <span class="st">"N (\u2030)"</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span><span class="op">)</span>,
  title <span class="op">=</span> <span class="st">"Isospace plot of Inger et al Geese data"</span>,
  mix_name <span class="op">=</span> <span class="st">"Organism"</span>
<span class="op">)</span></code></pre></div>
<p><img src="advanced_plotting_files/figure-html/unnamed-chunk-3-1.png" width="672" style="display: block; margin: auto;"></p>
<p>You can further customise by adding in extra ggplot commands, for example:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.window.html">xlim</a></span><span class="op">(</span><span class="op">-</span><span class="fl">50</span>, <span class="fl">50</span><span class="op">)</span> <span class="op">+</span> <span class="fu">labs</span><span class="op">(</span>subtitle <span class="op">=</span> <span class="st">"A subtitle goes here"</span><span class="op">)</span></code></pre></div>
<p><img src="advanced_plotting_files/figure-html/unnamed-chunk-4-1.png" width="672" style="display: block; margin: auto;"></p>
</div>
<div id="customisation-of-output-plots" class="section level2">
<h2 class="hasAnchor">
<a href="#customisation-of-output-plots" class="anchor"></a>Customisation of output plots</h2>
<p>The same idea as above can be used on output plots, for example:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">simmr_out</span>,
  type <span class="op">=</span> <span class="st">"boxplot"</span>,
  title <span class="op">=</span> <span class="st">"simmr"</span>
<span class="op">)</span></code></pre></div>
<p><img src="advanced_plotting_files/figure-html/unnamed-chunk-5-1.png" width="672" style="display: block; margin: auto;"></p>
<p>Now customise</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.window.html">ylim</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>subtitle <span class="op">=</span> <span class="st">"Something else"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ylab</span><span class="op">(</span><span class="st">"A new ylab"</span><span class="op">)</span></code></pre></div>
<pre><code>## Warning: Removed 3189 rows containing non-finite values (stat_boxplot).</code></pre>
<p><img src="advanced_plotting_files/figure-html/unnamed-chunk-6-1.png" width="672" style="display: block; margin: auto;"></p>
<p>If you cut off a part of the graph with e.g. a <code>ylim</code> command then R will provide a warning. Note that the above <code>ylim</code> command actually changes the x-axis and not the y-axis. This is because the coordinates are flipped in the underlying ggplot code which by default uses the source names on the horizontal axis. Here is a more complex example where I change the colours of the boxplots:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># First extract the dietary proportions</span>
<span class="va">simmr_out2</span> <span class="op">&lt;-</span> <span class="va">simmr_out</span><span class="op">$</span><span class="va">output</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">BUGSoutput</span><span class="op">$</span><span class="va">sims.list</span><span class="op">$</span><span class="va">p</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">simmr_out2</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">simmr_out</span><span class="op">$</span><span class="va">input</span><span class="op">$</span><span class="va">source_names</span>

<span class="co"># Now turn into a proper data frame</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/hadley/reshape">reshape2</a></span><span class="op">)</span>
<span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">reshape2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/melt.html">melt</a></span><span class="op">(</span><span class="va">simmr_out2</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Num"</span>, <span class="st">"Source"</span>, <span class="st">"Proportion"</span><span class="op">)</span>

<span class="co"># Finally create the new variable that you want to colour by</span>
<span class="va">df</span><span class="op">$</span><span class="va">new_colour</span> <span class="op">&lt;-</span> <span class="st">"Type 2"</span>
<span class="va">df</span><span class="op">$</span><span class="va">new_colour</span><span class="op">[</span><span class="va">df</span><span class="op">$</span><span class="va">Source</span> <span class="op">==</span> <span class="st">"Zostera"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"Type 1"</span>

<span class="co"># And create the plot</span>
<span class="fu">ggplot</span><span class="op">(</span><span class="va">df</span>, <span class="fu">aes_string</span><span class="op">(</span>
  y <span class="op">=</span> <span class="st">"Proportion"</span>, x <span class="op">=</span> <span class="st">"Source"</span>,
  fill <span class="op">=</span> <span class="st">"new_colour"</span>, alpha <span class="op">=</span> <span class="fl">0</span>, <span class="fl">5</span>
<span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_boxplot</span><span class="op">(</span>notch <span class="op">=</span> <span class="cn">TRUE</span>, outlier.size <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"simmr output boxplot with changed colours"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">coord_flip</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="advanced_plotting_files/figure-html/unnamed-chunk-7-1.png" width="672" style="display: block; margin: auto;"></p>
</div>
<div id="adding-in-convex-hulls-to-iso-space-plots" class="section level2">
<h2 class="hasAnchor">
<a href="#adding-in-convex-hulls-to-iso-space-plots" class="anchor"></a>Adding in convex hulls to iso-space plots</h2>
<p>It’s perfectly possible to add polygons and convex hulls to existing iso-space plots. This does require a bit of hacking though, and is assisted by use of the package <code>ggnewscale</code>. Starting for example with the iso-space plot above:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">simmr_in</span><span class="op">)</span></code></pre></div>
<p><img src="advanced_plotting_files/figure-html/unnamed-chunk-8-1.png" width="672" style="display: block; margin: auto;"></p>
<p>We can add a polygon around the mixtures by creating a new data frame with the source mean values (corrected by the TEFs). We have to augment this data frame to include some other parts of the data frame used by the <code>plot.simmr_input</code> function; we can set these to <code>NA</code>.</p>
<p>We first create the new data frame.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">ggnewscale</span><span class="op">)</span>
<span class="va">new_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
  x <span class="op">=</span> <span class="va">geese_data_day1</span><span class="op">$</span><span class="va">source_means</span><span class="op">[</span>, <span class="st">"meand13CPl"</span><span class="op">]</span> <span class="op">+</span> <span class="va">geese_data_day1</span><span class="op">$</span><span class="va">correction_means</span><span class="op">[</span>, <span class="st">"meand13CPl"</span><span class="op">]</span>,
  y <span class="op">=</span> <span class="va">geese_data_day1</span><span class="op">$</span><span class="va">source_means</span><span class="op">[</span>, <span class="st">"meand15NPl"</span><span class="op">]</span> <span class="op">+</span> <span class="va">geese_data_day1</span><span class="op">$</span><span class="va">correction_means</span><span class="op">[</span>, <span class="st">"meand15NPl"</span><span class="op">]</span>,
  x_lower <span class="op">=</span> <span class="cn">NA</span>,
  y_lower <span class="op">=</span> <span class="cn">NA</span>,
  x_upper <span class="op">=</span> <span class="cn">NA</span>,
  y_upper <span class="op">=</span> <span class="cn">NA</span>,
  Source <span class="op">=</span> <span class="st">"Mixtures"</span>,
  size <span class="op">=</span> <span class="cn">NA</span>
<span class="op">)</span></code></pre></div>
<p>Then we call the <code>new_scale_color</code> function from <code>ggnewscale</code> with the <code>geom_polygon</code> command to create the polygon</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggnewscale/man/new_scale.html">new_scale_color</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_polygon</span><span class="op">(</span>data <span class="op">=</span> <span class="va">new_df</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span>, fill <span class="op">=</span> <span class="st">"orange"</span>, alpha <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></code></pre></div>
<p><img src="advanced_plotting_files/figure-html/unnamed-chunk-10-1.png" width="672" style="display: block; margin: auto;"></p>
<p>If we wanted a convex hull we can use the <code>chull</code> function on the first two columns</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">chull_vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/chull.html">chull</a></span><span class="op">(</span><span class="va">new_df</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, <span class="va">new_df</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span>
<span class="va">new_df2</span> <span class="op">&lt;-</span> <span class="va">new_df</span><span class="op">[</span><span class="va">chull_vals</span>, <span class="op">]</span>
<span class="va">p</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggnewscale/man/new_scale.html">new_scale_color</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_polygon</span><span class="op">(</span>data <span class="op">=</span> <span class="va">new_df2</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span>, fill <span class="op">=</span> <span class="st">"orange"</span>, alpha <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></code></pre></div>
<p><img src="advanced_plotting_files/figure-html/unnamed-chunk-11-1.png" width="672" style="display: block; margin: auto;"></p>
<p>Or, finally, if we want a convex hull around the mixtures:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Create the new data frame</span>
<span class="va">new_mix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
  x <span class="op">=</span> <span class="va">geese_data_day1</span><span class="op">$</span><span class="va">mixtures</span><span class="op">[</span>, <span class="st">"d13C_Pl"</span><span class="op">]</span>,
  y <span class="op">=</span> <span class="va">geese_data_day1</span><span class="op">$</span><span class="va">mixtures</span><span class="op">[</span>, <span class="st">"d15N_Pl"</span><span class="op">]</span>,
  x_lower <span class="op">=</span> <span class="cn">NA</span>,
  y_lower <span class="op">=</span> <span class="cn">NA</span>,
  x_upper <span class="op">=</span> <span class="cn">NA</span>,
  y_upper <span class="op">=</span> <span class="cn">NA</span>,
  Source <span class="op">=</span> <span class="st">"Mixtures"</span>,
  size <span class="op">=</span> <span class="cn">NA</span>
<span class="op">)</span>
<span class="co"># Find the convex hull</span>
<span class="va">chull_mix_vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/chull.html">chull</a></span><span class="op">(</span><span class="va">new_mix</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, <span class="va">new_mix</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span>
<span class="va">new_mix2</span> <span class="op">&lt;-</span> <span class="va">new_mix</span><span class="op">[</span><span class="va">chull_mix_vals</span>, <span class="op">]</span>
<span class="co"># Plot using new_scale_color</span>
<span class="va">p</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggnewscale/man/new_scale.html">new_scale_color</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_polygon</span><span class="op">(</span>data <span class="op">=</span> <span class="va">new_mix2</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span>, fill <span class="op">=</span> <span class="st">"purple"</span>, alpha <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></code></pre></div>
<p><img src="advanced_plotting_files/figure-html/unnamed-chunk-12-1.png" width="672" style="display: block; margin: auto;"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Andrew Parnell.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
