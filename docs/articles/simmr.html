<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Stable Isotope Mixing Models in R with simmr • simmr</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Stable Isotope Mixing Models in R with simmr">
<meta property="og:description" content="simmr">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">simmr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.5.1.216</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/simmr.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/advanced_plotting.html">simmr: advanced plotting guide</a>
    </li>
    <li>
      <a href="../articles/quick_start.html">simmr: quick start guide</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/andrewcparnell/simmr/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Stable Isotope Mixing Models in R with
simmr</h1>
                        <h4 data-toc-skip class="author">Andrew Parnell
and Richard Inger</h4>
            
            <h4 data-toc-skip class="date">2023-10-27</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/andrewcparnell/simmr/blob/HEAD/vignettes/simmr.Rmd" class="external-link"><code>vignettes/simmr.Rmd</code></a></small>
      <div class="hidden name"><code>simmr.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>tl;dr see the <a href="https://cran.r-project.org/package=simmr/vignettes/quick_start.html" class="external-link">Quick
Start</a> vignette</p>
<p><code>simmr</code> is a package designed to solve mixing equations
for stable isotopic data within a Bayesian framework. This guide is
designed to get researchers up and running with the package and giving
them a full list of all the available features. No expertise is required
in the use of R.</p>
<p><code>simmr</code> is designed as an upgrade to the <a href="https://CRAN.R-project.org/package=siar" class="external-link">SIAR</a> package and
contains many of the same features. This new version contains a slightly
more sophisticated mixing model, a simpler user interface, and more
advanced plotting features. The key differences between SIAR and
<code>simmr</code> are:</p>
<ul>
<li>
<code>simmr</code> has a slightly richer mixing model based on code
from the Parnell et al 2013 Environmetrics paper</li>
<li>
<code>simmr</code> does not have a menu system; all commands must be
run through the console or script windows</li>
<li>
<code>simmr</code> uses ggplot2 to create graphs and JAGS to run the
mixing model</li>
</ul>
<p>We assume that you have a sound working knowledge of stable isotopic
mixing models, and the assumptions and potential pitfalls associated
with these models. A list of required reading is presented in Appendix A
of this guide. We strongly recommend reading Philips et al 2015,
Canadian Journal of Zoology for the basic assumptions and dos and don’ts
of running mixing models.</p>
<p>We assume that if you have got this far you have <a href="https://www.r-project.org" class="external-link">installed R</a>. We also recommend
installing <a href="https://posit.co" class="external-link">Rstudio</a> as this provides a
very neat interface to use R and <code>simmr</code>. The instructions
below all assume you are using Rstudio.</p>
<p>If you find bugs in the software, or wish to suggest new features,
please add your input to the <code>simmr</code> <a href="https://github.com/andrewcparnell/simmr/issues" class="external-link">GitHub issues
page</a>.</p>
</div>
<div class="section level2">
<h2 id="installation-of-the-simmr-package">Installation of the <code>simmr</code> package<a class="anchor" aria-label="anchor" href="#installation-of-the-simmr-package"></a>
</h2>
<p>The <code>simmr</code> package uses the JAGS (Just Another Gibbs
Sampler) programmer to run the stable isotope mixing model. Before you
install simmr, visit the <a href="https://sourceforge.net/projects/mcmc-jags/" class="external-link">JAGS</a> website and
download and install JAGS for your operating system.</p>
<p>Next, start Rstudio and find the window with the command prompt (the
symbol <code>&gt;</code>). Type</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"simmr"</span><span class="op">)</span></span></code></pre></div>
<p>It may ask you to pick your nearest CRAN mirror (the nearest site
which hosts R packages). You will then see some activity on the screen
as the <code>simmr</code> package and the other packages it uses are
downloaded. The final line should then read:</p>
<p><code>package 'simmr' successfully unpacked and MD5 sums checked</code></p>
<p>You then need to load the package. Type</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/andrewcparnell/simmr" class="external-link">simmr</a></span><span class="op">)</span></span></code></pre></div>
<p>This will load the <code>simmr</code> package and all the associated
packages. You’ll need to type the <code><a href="https://github.com/andrewcparnell/simmr" class="external-link">library(simmr)</a></code> command
every time you start R. If you haven’t installed JAGS properly you will
be informed at this point.</p>
</div>
<div class="section level2">
<h2 id="considerations-before-running-simmr">Considerations before running simmr<a class="anchor" aria-label="anchor" href="#considerations-before-running-simmr"></a>
</h2>
<p>Before getting started there are a couple of points to consider.</p>
<div class="section level3">
<h3 id="working-with-scripts">Working with scripts<a class="anchor" aria-label="anchor" href="#working-with-scripts"></a>
</h3>
<p>The best way to use the <code>simmr</code> package is by creating
scripts. A script can be created in Rstudio by clicking
<code>File &gt; New File &gt; Rscript</code>. This opens a text window
which allows commands to be typed in order and saved. The command can be
sent to the command prompt (which Rstudio calls the Console) by
highlighting the command and clicking Run (or going to Code &gt; Run
Lines). There are also keyboard shortcuts to speed up the process. We
strongly recommend you learn to run R via scripts.</p>
</div>
<div class="section level3">
<h3 id="data-structure">Data Structure<a class="anchor" aria-label="anchor" href="#data-structure"></a>
</h3>
<p><code>simmr</code> can handle three different types of data
structure:</p>
<ul>
<li>A single consumer. This may occur when you have only one data point
on a single individual</li>
<li>Multiple consumers. This may occur if you have multiple individuals
in a single sampling period</li>
<li>Multiple groups of consumers. This may occur if you have multiple
consumers which are observed over different sampling periods/locations,
different demographic groups, etc.</li>
</ul>
<p>Unless you specify a grouping variable <code>simmr</code> assumes
that all the observations are from the same group. If you have extra
variables (e.g. explanatory variables) that you think may influence the
dietary proportions, you should consider using <a href="https://github.com/brianstock/MixSIAR" class="external-link">MixSIAR</a> instead.</p>
</div>
</div>
<div class="section level2">
<h2 id="how-to-run-simmr">How to run simmr<a class="anchor" aria-label="anchor" href="#how-to-run-simmr"></a>
</h2>
<p>The general structure for running <code>simmr</code> is as
follows:</p>
<ol style="list-style-type: decimal">
<li>Call <code>simmr_load</code> on the data to get it into the right
format</li>
<li>Plot the data in isotope space (‘iso-space’) using
<code>plot</code>
</li>
<li>Run the mixing model with <code>simmr_mcmc</code> or
<code>simmr_ffvb</code>
</li>
<li>Check the model converged with <code>summary</code>
</li>
<li>Check the model fit is calibrated with
<code>posterior_predictive</code>
</li>
<li>Explore the results with <code>plot</code> and <code>summary</code>,
and <code>prior_viz</code>. If you have multiple groups and want to
compare output between them, use the `compare_groups’ function</li>
</ol>
<p>For the next part of this document, we concentrate on simple examples
without grouping structure.</p>
<div class="section level3">
<h3 id="step-1-getting-the-data-into-simmr">Step 1: Getting the data into simmr<a class="anchor" aria-label="anchor" href="#step-1-getting-the-data-into-simmr"></a>
</h3>
<p><code>simmr</code> requires at minimum 3 input objects; the consumers
or <em>mixtures</em>, the <em>source means</em>, and the <em>source
standard deviations</em>. Optionally, you can also add correction data
(also called trophic enrichment factors, TEFs) represented again as
means and standard deviations, and concentration dependence values. The
easiest way to get data into simmr is to create an Excel file, as shown
in the included <code>vignette('quick_start)</code> guide. Alternatively
you can copy and past your data, comma separated, as below:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="op">-</span><span class="fl">10.13</span>, <span class="op">-</span><span class="fl">10.72</span>, <span class="op">-</span><span class="fl">11.39</span>, <span class="op">-</span><span class="fl">11.18</span>, <span class="op">-</span><span class="fl">10.81</span>, <span class="op">-</span><span class="fl">10.7</span>, <span class="op">-</span><span class="fl">10.54</span>,</span>
<span>  <span class="op">-</span><span class="fl">10.48</span>, <span class="op">-</span><span class="fl">9.93</span>, <span class="op">-</span><span class="fl">9.37</span>, <span class="fl">11.59</span>, <span class="fl">11.01</span>, <span class="fl">10.59</span>, <span class="fl">10.97</span>, <span class="fl">11.52</span>, <span class="fl">11.89</span>,</span>
<span>  <span class="fl">11.73</span>, <span class="fl">10.89</span>, <span class="fl">11.05</span>, <span class="fl">12.3</span></span>
<span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">2</span>, nrow <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">mix</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"d13C"</span>, <span class="st">"d15N"</span><span class="op">)</span></span>
<span><span class="va">s_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Zostera"</span>, <span class="st">"Grass"</span>, <span class="st">"U.lactuca"</span>, <span class="st">"Enteromorpha"</span><span class="op">)</span></span>
<span><span class="va">s_means</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">14</span>, <span class="op">-</span><span class="fl">15.1</span>, <span class="op">-</span><span class="fl">11.03</span>, <span class="op">-</span><span class="fl">14.44</span>, <span class="fl">3.06</span>, <span class="fl">7.05</span>, <span class="fl">13.72</span>, <span class="fl">5.96</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">2</span>, nrow <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">s_sds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.48</span>, <span class="fl">0.38</span>, <span class="fl">0.48</span>, <span class="fl">0.43</span>, <span class="fl">0.46</span>, <span class="fl">0.39</span>, <span class="fl">0.42</span>, <span class="fl">0.48</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">2</span>, nrow <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">c_means</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2.63</span>, <span class="fl">1.59</span>, <span class="fl">3.41</span>, <span class="fl">3.04</span>, <span class="fl">3.28</span>, <span class="fl">2.34</span>, <span class="fl">2.14</span>, <span class="fl">2.36</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">2</span>, nrow <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">c_sds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.41</span>, <span class="fl">0.44</span>, <span class="fl">0.34</span>, <span class="fl">0.46</span>, <span class="fl">0.46</span>, <span class="fl">0.48</span>, <span class="fl">0.46</span>, <span class="fl">0.66</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">2</span>, nrow <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">conc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.02</span>, <span class="fl">0.1</span>, <span class="fl">0.12</span>, <span class="fl">0.04</span>, <span class="fl">0.02</span>, <span class="fl">0.1</span>, <span class="fl">0.09</span>, <span class="fl">0.05</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">2</span>, nrow <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></code></pre></div>
<p>The <code>mix</code> object above contains the stable isotopic data
for the consumers. The data should be listed as the consumer values for
the first isotope, followed by the consumer values for the second
isotope and so on. The <code>matrix</code> function turns this into a
matrix (a rectangle of numbers) with 2 columns. The first column
contains the data for isotope 1, and the second the data for isotope 2.
Any number of isotopes and observations can be used. It is recommended
but not necessary to give the mixtures column names representing the
isotopes to which each column corresponds.</p>
<p>The source names are provided in the <code>s_names</code> object, and
the source means and standard deviations in <code>s_means</code> and
<code>s_sds</code>. These latter objects must also be matrices, where
the number of rows is the number of sources, and the number of columns
the number of isotopes. In each case, the data are included by listing
the values for the first isotope, then the second isotope, and so
on.</p>
<p>The correction data is stored in <code>c_means</code> and
<code>c_sds</code>. Again this should be a matrix of the same dimension
as <code>s_means</code> and <code>s_sds</code>. Finally the
concentration dependencies (i.e. the elemental concentration values) are
included as <code>conc</code>.</p>
<p>Some data sets are also included in <code>simmr</code> for quick
access to examples. See <code>data(package = "simmr")</code> for the
list. They can all be accessed via,
e.g. <code>data("geese_data")</code>.</p>
<p>To load the data into simmr, use:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">simmr_in</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simmr_load.html">simmr_load</a></span><span class="op">(</span></span>
<span>  mixtures <span class="op">=</span> <span class="va">mix</span>,</span>
<span>  source_names <span class="op">=</span> <span class="va">s_names</span>,</span>
<span>  source_means <span class="op">=</span> <span class="va">s_means</span>,</span>
<span>  source_sds <span class="op">=</span> <span class="va">s_sds</span>,</span>
<span>  correction_means <span class="op">=</span> <span class="va">c_means</span>,</span>
<span>  correction_sds <span class="op">=</span> <span class="va">c_sds</span>,</span>
<span>  concentration_means <span class="op">=</span> <span class="va">conc</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Remember that the <code>correction_means</code>,
<code>correction_sds</code>, and <code>concentration_means</code> are
optional.</p>
</div>
<div class="section level3">
<h3 id="step-2-plotting-the-data-in-iso-space">Step 2: Plotting the data in iso-space<a class="anchor" aria-label="anchor" href="#step-2-plotting-the-data-in-iso-space"></a>
</h3>
<p>We can now plot the raw isotopic data with:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">simmr_in</span><span class="op">)</span></span></code></pre></div>
<p><img src="simmr_files/figure-html/unnamed-chunk-6-1.png" width="672" style="display: block; margin: auto;"></p>
<p>This will produce a biplot with the isotope that is in the first
column on the x-axis, and the isotope in the second column on the
y-axis. You can make the plot slightly nicer with some extra
arguments:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">simmr_in</span>,</span>
<span>  xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">delta</span><span class="op">^</span><span class="fl">13</span>, <span class="st">"C (per mille)"</span>,</span>
<span>    sep <span class="op">=</span> <span class="st">""</span></span>
<span>  <span class="op">)</span><span class="op">)</span>,</span>
<span>  ylab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">delta</span><span class="op">^</span><span class="fl">15</span>, <span class="st">"N (per mille)"</span>,</span>
<span>    sep <span class="op">=</span> <span class="st">""</span></span>
<span>  <span class="op">)</span><span class="op">)</span>,</span>
<span>  title <span class="op">=</span> <span class="st">"Isospace plot of example data"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="simmr_files/figure-html/unnamed-chunk-7-1.png" width="672" style="display: block; margin: auto;"></p>
<p>See the help file <code><a href="../reference/plot.simmr_input.html">help(plot.simmr_input)</a></code> for more
options on the plotting commands, including the ability to plot
different tracers/isotopes when there are more than 2 isotopes.</p>
<p>If all the mixtures lie inside the mixing polygon defined by the
sources, then the data are acceptable for running <code>simmr</code>.
See Philips et al 2015, Canadian Journal of Zoology for more details on
when data are suitable for running through a mixing model.</p>
</div>
<div class="section level3">
<h3 id="step-3-running-simmr">Step 3: Running simmr<a class="anchor" aria-label="anchor" href="#step-3-running-simmr"></a>
</h3>
<p>The next step is to actually run the model. There are two options to
choose from here. The code to run the model using a Markov chain Monte
Carlo (MCMC) algorithm is as follows:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">simmr_out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simmr_mcmc.html">simmr_mcmc</a></span><span class="op">(</span><span class="va">simmr_in</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## module glm loaded</span></span></code></pre>
<p>This command takes the object <code>simmr_in</code> we created
earlier and uses it as input for the model. It tells <code>simmr</code>
to store the output from the model run in an object called
<code>simmr_out</code>.</p>
<p>Alternatively, it can be run using a Fixed Form Variational Bayes
(FFVB) algorithm, as follows:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">simmr_out_ffvb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simmr_ffvb.html">simmr_ffvb</a></span><span class="op">(</span><span class="va">simmr_in</span><span class="op">)</span></span></code></pre></div>
<p>The model should take less than a minute to run, though this will
depend on the speed of the computer you are using. Other data sets might
take slightly longer or shorter depending on the number of sources,
isotopes, and observations. The progress of the model is displayed on
the command line window, which shows the percentage complete.</p>
</div>
<div class="section level3">
<h3 id="step-4-checking-the-algorithm-converged">Step 4: Checking the algorithm converged<a class="anchor" aria-label="anchor" href="#step-4-checking-the-algorithm-converged"></a>
</h3>
<p>Markov chain Monte Carlo (MCMC) works by repeatedly guessing the
values of the dietary proportions and find those values which fit the
data best. The initial guesses are usually poor and are discarded as
part of an initial phase known as the burn-in. Subsequent iterations are
then stored and used for the <em>posterior distribution</em>; the best
estimates of the dietary proportions given the data and the model.
Because it can take many thousands of iterations to move away from the
initial guesses, <em>convergence diagnostics</em> can be created to
check the model has run properly. In <code>simmr</code> this is done
with:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">simmr_out</span>, type <span class="op">=</span> <span class="st">"diagnostics"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Summary for 1</span></span></code></pre>
<pre><code><span><span class="co">## R-hat values - these values should all be close to 1.</span></span></code></pre>
<pre><code><span><span class="co">## If not, try a longer run of simmr_mcmc.</span></span></code></pre>
<pre><code><span><span class="co">##     deviance      Zostera        Grass    U.lactuca Enteromorpha     sd[d13C] </span></span>
<span><span class="co">##            1            1            1            1            1            1 </span></span>
<span><span class="co">##     sd[d15N] </span></span>
<span><span class="co">##            1</span></span></code></pre>
<p>If the model run has converged properly the values should be close to
1. If they are above 1.1, we recommend a longer run. See
<code><a href="../reference/simmr_mcmc.html">help(simmr_mcmc)</a></code> for how to do this.</p>
<p>Fixed Form Variational Bayes (FFVB) is an optimisation based
technique. It doesn’t require this diagnostic function.</p>
</div>
<div class="section level3">
<h3 id="step-5-checking-the-model-fit">Step 5: Checking the model fit<a class="anchor" aria-label="anchor" href="#step-5-checking-the-model-fit"></a>
</h3>
<p>You can check the fit of the model with a posterior predictive check.
This is similar to a fitted values plot in a linear regression. If the
data points (denoted by the plot as <span class="math inline">\(y\)</span>) broadly lie in the fitted value
intervals (denoted <span class="math inline">\(y_rep\)</span>; the
default is a 50% interval) then the model is fitting well:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">post_pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/posterior_predictive.html">posterior_predictive</a></span><span class="op">(</span><span class="va">simmr_out</span><span class="op">)</span></span></code></pre></div>
<p><img src="simmr_files/figure-html/unnamed-chunk-11-1.png" width="672" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">post_pred</span><span class="op">)</span></span></code></pre></div>
<p>The output includes a table showing which observations lie outside
the posterior predictive and the proportion doing so, which should
approximately match the proportion specified in the
<code>posterior_predictive</code> function (default 50%).</p>
</div>
<div class="section level3">
<h3 id="step-6-exploring-the-results">Step 6: Exploring the results<a class="anchor" aria-label="anchor" href="#step-6-exploring-the-results"></a>
</h3>
<p>All SIMMs use informative (usually generalist) prior distributions as
a default. These functions work whether the model has been run through
MCMC or FFVB. You can plot the priors and the posteriors with:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/prior_viz.html">prior_viz</a></span><span class="op">(</span><span class="va">simmr_out</span><span class="op">)</span></span></code></pre></div>
<p><img src="simmr_files/figure-html/unnamed-chunk-12-1.png" width="672" style="display: block; margin: auto;"></p>
<p><code>simmr</code> produces both textual and graphical summaries of
the model run. Starting with the textual summaries, we can get tables of
the means, standard deviations and credible intervals (the Bayesian
equivalent of a confidence interval) with:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">simmr_out</span>, type <span class="op">=</span> <span class="st">"statistics"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Summary for 1</span></span></code></pre>
<pre><code><span><span class="co">##                mean    sd</span></span>
<span><span class="co">## deviance     39.278 4.950</span></span>
<span><span class="co">## Zostera       0.232 0.134</span></span>
<span><span class="co">## Grass         0.275 0.088</span></span>
<span><span class="co">## U.lactuca     0.272 0.037</span></span>
<span><span class="co">## Enteromorpha  0.222 0.123</span></span>
<span><span class="co">## sd[d13C]      0.743 0.301</span></span>
<span><span class="co">## sd[d15N]      0.664 0.299</span></span></code></pre>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">simmr_out</span>, type <span class="op">=</span> <span class="st">"quantiles"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Summary for 1</span></span></code></pre>
<pre><code><span><span class="co">##                2.5%    25%    50%    75%  97.5%</span></span>
<span><span class="co">## deviance     32.695 35.599 38.327 41.908 51.477</span></span>
<span><span class="co">## Zostera       0.033  0.122  0.216  0.326  0.516</span></span>
<span><span class="co">## Grass         0.118  0.214  0.270  0.330  0.467</span></span>
<span><span class="co">## U.lactuca     0.202  0.246  0.270  0.295  0.351</span></span>
<span><span class="co">## Enteromorpha  0.036  0.124  0.209  0.305  0.492</span></span>
<span><span class="co">## sd[d13C]      0.328  0.541  0.689  0.885  1.446</span></span>
<span><span class="co">## sd[d15N]      0.244  0.463  0.612  0.797  1.406</span></span></code></pre>
<p>These suggest that the dietary proportions for this model are quite
uncertain. However we can see that the credible interval for U.lactuca
is the narrowest, running from approximately 20% to 35% of the diet. The
reason this one is the narrowest can be seen from the isospace plot -
this source is the most clearly separated from the others.</p>
<p><code>simmr</code> can also produce histograms, boxplots, density
plots, and matrix plots of the output. Starting with the density
plot:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">simmr_out</span>, type <span class="op">=</span> <span class="st">"density"</span><span class="op">)</span></span></code></pre></div>
<p><img src="simmr_files/figure-html/unnamed-chunk-14-1.png" width="672" style="display: block; margin: auto;"></p>
<p>We can see that Zostera and Enteromorpha are poorly constrained in
comparison to Grass and especially U.lactuca. Again this is unsurprising
since the isospace plot indicated that these were the two most clearly
separated sources.</p>
<p>The most useful output plot is the matrix plot:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">simmr_out</span>, type <span class="op">=</span> <span class="st">"matrix"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Registered S3 method overwritten by 'GGally':</span></span>
<span><span class="co">##   method from   </span></span>
<span><span class="co">##   +.gg   ggplot2</span></span></code></pre>
<p><img src="simmr_files/figure-html/unnamed-chunk-15-1.png" width="672" style="display: block; margin: auto;"></p>
<p>This shows the source histograms on the diagonal, contour plots of
the relationship between the sources on the upper diagonal, and the
correlation between the sources on the lower diagonal. Large negative
correlations indicate that the model cannot discern between the two
sources; they may lie close together in iso-space. Large positive
correlations are also possible when mixture data lie in a polygon
consisting of multiple competing sources. Here the largest negative
correlation is between Zostera and Enteromorpha. This is because they
lie closest together in isospace. In general, high correlations
(negative or positive) are indicative of the model being unable to
determine which food sources are being consumed, and are an unavoidable
part of stable isotope mixing models.</p>
<p>If you want to compare the dietary proportions between two different
sources, you can use the <code>compare_sources</code> function. This
takes two or more sources and compares the dietary proportions with an
optional plot. For example:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/compare_sources.html">compare_sources</a></span><span class="op">(</span><span class="va">simmr_out</span>,</span>
<span>  source_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Zostera"</span>, <span class="st">"U.lactuca"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Prob (proportion of Zostera &gt; proportion of U.lactuca) = 0.376</span></span></code></pre>
<p><img src="simmr_files/figure-html/unnamed-chunk-16-1.png" width="672" style="display: block; margin: auto;"></p>
<p>This produces a direct probability that the dietary proportion for
the first source is bigger than that of the second. If you want to
compare more than two sources, specify them with:</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/compare_sources.html">compare_sources</a></span><span class="op">(</span><span class="va">simmr_out</span>,</span>
<span>  source_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"Zostera"</span>,</span>
<span>    <span class="st">"U.lactuca"</span>,</span>
<span>    <span class="st">"Enteromorpha"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Most popular orderings are as follows:</span></span></code></pre>
<pre><code><span><span class="co">##                                    Probability</span></span>
<span><span class="co">## Zostera &gt; U.lactuca &gt; Enteromorpha      0.3031</span></span>
<span><span class="co">## Enteromorpha &gt; U.lactuca &gt; Zostera      0.2594</span></span>
<span><span class="co">## U.lactuca &gt; Enteromorpha &gt; Zostera      0.1958</span></span>
<span><span class="co">## U.lactuca &gt; Zostera &gt; Enteromorpha      0.1689</span></span>
<span><span class="co">## Zostera &gt; Enteromorpha &gt; U.lactuca      0.0386</span></span>
<span><span class="co">## Enteromorpha &gt; Zostera &gt; U.lactuca      0.0342</span></span></code></pre>
<p><img src="simmr_files/figure-html/unnamed-chunk-17-1.png" width="672" style="display: block; margin: auto;"></p>
<p>For further information and options on comparing sources, see
<code><a href="../reference/compare_sources.html">help(compare_sources)</a></code>.</p>
</div>
</div>
<div class="section level2">
<h2 id="how-to-run-simmr-on-multiple-groups">How to run <code>simmr</code> on multiple groups<a class="anchor" aria-label="anchor" href="#how-to-run-simmr-on-multiple-groups"></a>
</h2>
<p>In many cases we have data from different sampling locations, or
different types of individuals (e.g. male/female) and we to compare
between these groups. <code>simmr</code> can handle these data sets
provided they all share the same sources, corrections and concentration
dependence values.</p>
<p>A useful data set is given by Inger et al 2006 and provided as part
of the original SIAR package. These data concern Brent Geese observed on
8 separate sampling periods.</p>
<p>These data are included in the package, and we can load these data
into R with:</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">geese_data</span><span class="op">)</span></span></code></pre></div>
<p>…and into simmr with:</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">simmr_groups</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span></span>
<span>  <span class="va">geese_data</span>,</span>
<span>  <span class="fu"><a href="../reference/simmr_load.html">simmr_load</a></span><span class="op">(</span></span>
<span>    mixtures <span class="op">=</span> <span class="va">mixtures</span>,</span>
<span>    source_names <span class="op">=</span> <span class="va">source_names</span>,</span>
<span>    source_means <span class="op">=</span> <span class="va">source_means</span>,</span>
<span>    source_sds <span class="op">=</span> <span class="va">source_sds</span>,</span>
<span>    correction_means <span class="op">=</span> <span class="va">correction_means</span>,</span>
<span>    correction_sds <span class="op">=</span> <span class="va">correction_sds</span>,</span>
<span>    concentration_means <span class="op">=</span> <span class="va">concentration_means</span>,</span>
<span>    group <span class="op">=</span> <span class="va">groups</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Note that the <code>group</code> object above is specified to be a
factor but can also be an integer, the levels of which will appear in
plots. However, when specifying groups in later commands you should use
the integer values to reference which groups to plot</p>
<p>Next it is a matter of following the <code>simmr</code> commands as
before to load in, with an extra argument specifying the groups:</p>
<p>When we create the isospace plot we can specify which groups we wish
to plot:</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">simmr_groups</span>,</span>
<span>  group <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">8</span>,</span>
<span>  xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">delta</span><span class="op">^</span><span class="fl">13</span>, <span class="st">"C (per mille)"</span>,</span>
<span>    sep <span class="op">=</span> <span class="st">""</span></span>
<span>  <span class="op">)</span><span class="op">)</span>,</span>
<span>  ylab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">delta</span><span class="op">^</span><span class="fl">15</span>, <span class="st">"N (per mille)"</span>,</span>
<span>    sep <span class="op">=</span> <span class="st">""</span></span>
<span>  <span class="op">)</span><span class="op">)</span>,</span>
<span>  title <span class="op">=</span> <span class="st">"Isospace plot of Inger et al Geese data"</span>,</span>
<span>  mix_name <span class="op">=</span> <span class="st">"Geese"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>In the above code <code>group = 1:8</code> can be changed specify any
of the available groups. For example <code>group = 2</code> would plot
just sampling period 2, or <code>group = c(1,3:7)</code> would plot just
sampling period 1 and 3 to 7.</p>
<p>The command for running the <code>simmr</code> model is identical to
before:</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">simmr_groups_out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simmr_mcmc.html">simmr_mcmc</a></span><span class="op">(</span><span class="va">simmr_groups</span><span class="op">)</span></span></code></pre></div>
<p>or</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">simmr_groups_out_ffvb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simmr_ffvb.html">simmr_ffvb</a></span><span class="op">(</span><span class="va">simmr_groups</span><span class="op">)</span></span></code></pre></div>
<p><code>simmr</code> will automatically run the model for each group in
turn. This may take slightly longer than a standard single group
run.</p>
<p>The <code>summary</code> command works the same as before. By default
they will produce output for all groups, or you can specify the groups
individually, e.g.:</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">simmr_groups_out</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"quantiles"</span>,</span>
<span>  group <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">simmr_groups_out</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"quantiles"</span>,</span>
<span>  group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">simmr_groups_out</span>,</span>
<span>  type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"quantiles"</span>, <span class="st">"statistics"</span><span class="op">)</span>,</span>
<span>  group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>For plotting output with multiple groups you can only specify a
single group to plot. This is so that you are not overwhelmed with
plots:</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">simmr_groups_out</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"boxplot"</span>,</span>
<span>  group <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  title <span class="op">=</span> <span class="st">"simmr output group 2"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">simmr_groups_out</span>,</span>
<span>  type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"density"</span>, <span class="st">"matrix"</span><span class="op">)</span>,</span>
<span>  group <span class="op">=</span> <span class="fl">6</span>,</span>
<span>  title <span class="op">=</span> <span class="st">"simmr output group 6"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Whilst you can use the <code>compare_sources</code> function for
multi-group data, there is also an extra function for comparing a single
source between groups via the <code>compare_groups</code> function. This
allows for probabilistic output and plots comparing a single source
across different groups. The simplest use is where you want to compare
just two groups:</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/compare_groups.html">compare_groups</a></span><span class="op">(</span><span class="va">simmr_groups_out</span>,</span>
<span>  source <span class="op">=</span> <span class="st">"Zostera"</span>,</span>
<span>  groups <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>This produces the probability of the group 1 dietary proportion of
Zostera being greater than that of group 2. It also produces a boxplot
of the difference between the dietary proportions and will save this
into a new object if specified. You can turn the plot off by adding the
argument <code>plot = FALSE</code>.</p>
<p>If you specify more than two groups <code>simmr</code> will produce
the most likely probabilistic orderings of the groups as well as the
boxplot as before:</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/compare_groups.html">compare_groups</a></span><span class="op">(</span><span class="va">simmr_groups_out</span>,</span>
<span>  source <span class="op">=</span> <span class="st">"Zostera"</span>,</span>
<span>  groups <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="combining-sources">Combining sources<a class="anchor" aria-label="anchor" href="#combining-sources"></a>
</h2>
<p>A common request is that of combining sources. We would recommend
always doing this after running simmr, known as <em>a-posteriori</em>
combining. Suppose for example, you wish to combine the U.lactuca and
Enteromorpha sources which lie in a similar region in the isospace plot
of the Geese data. To proceed, we can create a new <code>simmr</code>
object using the <code>combine_sources</code> function:</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">simmr_out_combine</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/combine_sources.html">combine_sources</a></span><span class="op">(</span><span class="va">simmr_out</span>,</span>
<span>  to_combine <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"Grass"</span>,</span>
<span>    <span class="st">"Enteromorpha"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  new_source_name <span class="op">=</span> <span class="st">"U.lac+Ent"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">simmr_out_combine</span><span class="op">$</span><span class="va">input</span><span class="op">)</span></span></code></pre></div>
<p><img src="simmr_files/figure-html/unnamed-chunk-27-1.png" width="672" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">simmr_out_combine</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"boxplot"</span>,</span>
<span>  title <span class="op">=</span> <span class="st">"simmr output: combined sources"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="simmr_files/figure-html/unnamed-chunk-27-2.png" width="672" style="display: block; margin: auto;"></p>
<p>This will also work with multiple sources and/or multiple groups:</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">simmr_groups_out_combine</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/combine_sources.html">combine_sources</a></span><span class="op">(</span><span class="va">simmr_groups_out</span>,</span>
<span>  to_combine <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"Zostera"</span>,</span>
<span>    <span class="st">"U.lactuca"</span>,</span>
<span>    <span class="st">"Enteromorpha"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  new_source_name <span class="op">=</span> <span class="st">"U.Lac+Ent+Zos"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">simmr_groups_out_combine</span><span class="op">$</span><span class="va">input</span>,</span>
<span>  group <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">8</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">simmr_groups_out_combine</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"boxplot"</span>,</span>
<span>  title <span class="op">=</span> <span class="st">"simmr output: combined sources"</span>,</span>
<span>  group <span class="op">=</span> <span class="fl">8</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">simmr_groups_out_combine</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"matrix"</span>,</span>
<span>  title <span class="op">=</span> <span class="st">"simmr output: combined sources"</span>,</span>
<span>  group <span class="op">=</span> <span class="fl">8</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># And we can now compare sources across groups on this new data set</span></span>
<span><span class="fu"><a href="../reference/compare_groups.html">compare_groups</a></span><span class="op">(</span><span class="va">simmr_groups_out_combine</span>,</span>
<span>  source <span class="op">=</span> <span class="st">"U.Lac+Ent+Zos"</span>,</span>
<span>  group <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="running-simmr-with-only-one-isotope">Running simmr with only one isotope<a class="anchor" aria-label="anchor" href="#running-simmr-with-only-one-isotope"></a>
</h2>
<p><code>simmr</code> will run fine with only one tracer, and no changes
should be required to any of the functions. Here is an example with only
one isotope:</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="op">-</span><span class="fl">10.13</span>, <span class="op">-</span><span class="fl">10.72</span>, <span class="op">-</span><span class="fl">11.39</span>, <span class="op">-</span><span class="fl">11.18</span>, <span class="op">-</span><span class="fl">10.81</span>, <span class="op">-</span><span class="fl">10.7</span>, <span class="op">-</span><span class="fl">10.54</span>,</span>
<span>  <span class="op">-</span><span class="fl">10.48</span>, <span class="op">-</span><span class="fl">9.93</span>, <span class="op">-</span><span class="fl">9.37</span></span>
<span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">1</span>, nrow <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">mix</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"d13C"</span><span class="op">)</span></span>
<span><span class="va">s_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Zostera"</span>, <span class="st">"Grass"</span>, <span class="st">"U.lactuca"</span>, <span class="st">"Enteromorpha"</span><span class="op">)</span></span>
<span><span class="va">s_means</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">14</span>, <span class="op">-</span><span class="fl">15.1</span>, <span class="op">-</span><span class="fl">11.03</span>, <span class="op">-</span><span class="fl">14.44</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">1</span>, nrow <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">s_sds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.48</span>, <span class="fl">0.38</span>, <span class="fl">0.48</span>, <span class="fl">0.43</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">1</span>, nrow <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">c_means</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2.63</span>, <span class="fl">1.59</span>, <span class="fl">3.41</span>, <span class="fl">3.04</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">1</span>, nrow <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">c_sds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.41</span>, <span class="fl">0.44</span>, <span class="fl">0.34</span>, <span class="fl">0.46</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">1</span>, nrow <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">conc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.02</span>, <span class="fl">0.1</span>, <span class="fl">0.12</span>, <span class="fl">0.04</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">1</span>, nrow <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></code></pre></div>
<p>Now load in with <code>simmr_load</code>:</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">simmr_in_1D</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simmr_load.html">simmr_load</a></span><span class="op">(</span></span>
<span>  mixtures <span class="op">=</span> <span class="va">mix</span>,</span>
<span>  source_names <span class="op">=</span> <span class="va">s_names</span>,</span>
<span>  source_means <span class="op">=</span> <span class="va">s_means</span>,</span>
<span>  source_sds <span class="op">=</span> <span class="va">s_sds</span>,</span>
<span>  correction_means <span class="op">=</span> <span class="va">c_means</span>,</span>
<span>  correction_sds <span class="op">=</span> <span class="va">c_sds</span>,</span>
<span>  concentration_means <span class="op">=</span> <span class="va">conc</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Create a plot. <code>plot.simmr_input</code> automatically creates a
1D version of these plots:</p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">simmr_in_1D</span><span class="op">)</span></span></code></pre></div>
<p><img src="simmr_files/figure-html/unnamed-chunk-31-1.png" width="700"></p>
<p>Now run simmr:</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">simmr_run_1D</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simmr_mcmc.html">simmr_mcmc</a></span><span class="op">(</span><span class="va">simmr_in_1D</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Compiling model graph</span></span>
<span><span class="co">##    Resolving undeclared variables</span></span>
<span><span class="co">##    Allocating nodes</span></span>
<span><span class="co">## Graph information:</span></span>
<span><span class="co">##    Observed stochastic nodes: 10</span></span>
<span><span class="co">##    Unobserved stochastic nodes: 5</span></span>
<span><span class="co">##    Total graph size: 83</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Initializing model</span></span></code></pre>
<p>or</p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">simmr_run_1D_ffvb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simmr_ffvb.html">simmr_ffvb</a></span><span class="op">(</span><span class="va">simmr_in_1D</span><span class="op">)</span></span></code></pre></div>
<p>Plot output</p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">simmr_run_1D</span>, type <span class="op">=</span> <span class="st">"boxplot"</span><span class="op">)</span></span></code></pre></div>
<p><img src="simmr_files/figure-html/unnamed-chunk-34-1.png" width="700"></p>
<p>The other <code>summary</code>, <code>compare</code> and
<code>plot</code> functions should all work the same.</p>
</div>
<div class="section level2">
<h2 id="setting-up-your-own-prior-distributions">Setting up your own prior distributions<a class="anchor" aria-label="anchor" href="#setting-up-your-own-prior-distributions"></a>
</h2>
<p>Most Bayesian models will work better when you include informative
prior distributions on the dietary proportions. For arguments as to why
you should use prior informative information (and where you could get it
from), see <a href="https://github.com/andrewcparnell/simms_course/blob/master/papers/Phillips_SIMMadvice_2014.pdf" class="external-link">here</a>.
<code>simmr</code> tries to make this easier for practitioners by
including a specific function (`simmr_elicit’) for including prior
information.</p>
<p>We will use the <code>simmr_out</code> object created above. A
reminder about the posterior values</p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">simmr_out</span>, type <span class="op">=</span> <span class="st">"quantiles"</span><span class="op">)</span></span></code></pre></div>
<p>All these dietary proportions are very similar. We now suppose we had
prior information (e.g. from stomach or fecal contents) that the mean
dietary proportions were</p>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">proportion_means</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.4</span>, <span class="fl">0.3</span>, <span class="fl">0.2</span>, <span class="fl">0.1</span><span class="op">)</span></span></code></pre></div>
<p>…and proportion standard deviations:</p>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">proportion_sds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.08</span>, <span class="fl">0.02</span>, <span class="fl">0.01</span>, <span class="fl">0.02</span><span class="op">)</span></span></code></pre></div>
<p>We put this into the <code>simmr_elicit</code> function as
follows:</p>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">prior</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simmr_elicit.html">simmr_elicit</a></span><span class="op">(</span></span>
<span>  <span class="fl">4</span>, <span class="va">proportion_means</span>,</span>
<span>  <span class="va">proportion_sds</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>This may take a few moments to run as the code tries to optimise the
parameters of a prior distribution which matches these means and
standard deviations, which sometimes may not be exactly possible.</p>
<p>When finished, the model can be run using these prior
distributions:</p>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">simmr_out_informative</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simmr_mcmc.html">simmr_mcmc</a></span><span class="op">(</span><span class="va">simmr_in</span>,</span>
<span>  prior_control <span class="op">=</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>      means <span class="op">=</span> <span class="va">prior</span><span class="op">$</span><span class="va">mean</span>,</span>
<span>      sd <span class="op">=</span> <span class="va">prior</span><span class="op">$</span><span class="va">sd</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The new quantiles are:</p>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">simmr_out_informative</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"quantiles"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>We can plot these priors with their posteriors</p>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/prior_viz.html">prior_viz</a></span><span class="op">(</span><span class="va">simmr_out_informative</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="customising-plots">Customising plots<a class="anchor" aria-label="anchor" href="#customising-plots"></a>
</h2>
<p>Many of the plots in <code>simmr</code> can be customised by adding
on extra options just like a standard <code>ggplot</code>. For
example:</p>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">simmr_in</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">xlim</a></span><span class="op">(</span><span class="op">-</span><span class="fl">100</span>, <span class="fl">100</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">ylim</a></span><span class="op">(</span><span class="op">-</span><span class="fl">100</span>, <span class="fl">100</span><span class="op">)</span></span></code></pre></div>
<p><img src="simmr_files/figure-html/unnamed-chunk-42-1.png" width="672" style="display: block; margin: auto;"><img src="simmr_files/figure-html/unnamed-chunk-42-2.png" width="672" style="display: block; margin: auto;"></p>
<p>or even on the output:</p>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">simmr_groups_out</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"boxplot"</span>,</span>
<span>  group <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  title <span class="op">=</span> <span class="st">"simmr output group 2"</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">ylim</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.5</span><span class="op">)</span></span></code></pre></div>
<p>Note that the above actually changes the x-axis and not the y-axis
despite the above command. This is because the coordinates are flipped
in the ggplot.</p>
<p>Other options you might like to customise include labels on axes,
titles/subtitles, etc. More complicated changes can be made but these
involve changing the ggplot commands that simmr uses in the
background.</p>
<p>Here is an example where I change the colours of the boxplots:</p>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># First extract the dietary proportions</span></span>
<span><span class="va">simmr_out2</span> <span class="op">&lt;-</span> <span class="va">simmr_out</span><span class="op">$</span><span class="va">output</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">BUGSoutput</span><span class="op">$</span><span class="va">sims.list</span><span class="op">$</span><span class="va">p</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">simmr_out2</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">simmr_out</span><span class="op">$</span><span class="va">input</span><span class="op">$</span><span class="va">source_names</span></span>
<span></span>
<span><span class="co"># Now turn into a proper data frame</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">reshape2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/melt.html" class="external-link">melt</a></span><span class="op">(</span><span class="va">simmr_out2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Num"</span>, <span class="st">"Source"</span>, <span class="st">"Proportion"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Finally create the new variable that you want to colour by</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">new_colour</span> <span class="op">&lt;-</span> <span class="st">"Type 2"</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">new_colour</span><span class="op">[</span><span class="va">df</span><span class="op">$</span><span class="va">Source</span> <span class="op">==</span> <span class="st">"Zostera"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"Type 1"</span></span>
<span></span>
<span><span class="co"># And create the plot</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_.html" class="external-link">aes_string</a></span><span class="op">(</span></span>
<span>  y <span class="op">=</span> <span class="st">"Proportion"</span>, x <span class="op">=</span> <span class="st">"Source"</span>,</span>
<span>  fill <span class="op">=</span> <span class="st">"new_colour"</span>, alpha <span class="op">=</span> <span class="fl">0</span>, <span class="fl">5</span></span>
<span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot</a></span><span class="op">(</span>notch <span class="op">=</span> <span class="cn">TRUE</span>, outlier.size <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"simmr output boxplot with changed colours"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html" class="external-link">coord_flip</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: `aes_string()` was deprecated in ggplot2 3.0.0.</span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Please use tidy evaluation idioms with `aes()`.</span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> See also `vignette("ggplot2-in-packages")` for more information.</span></span>
<span><span class="co">## <span style="color: #555555;">This warning is displayed once every 8 hours.</span></span></span>
<span><span class="co">## <span style="color: #555555;">Call `lifecycle::last_lifecycle_warnings()` to see where this warning was</span></span></span>
<span><span class="co">## <span style="color: #555555;">generated.</span></span></span></code></pre>
<p><img src="simmr_files/figure-html/unnamed-chunk-44-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="other-advanced-use-of-simmr">Other advanced use of simmr<a class="anchor" aria-label="anchor" href="#other-advanced-use-of-simmr"></a>
</h2>
<p>Whilst the above gives an introduction to the basic functions of
simmr, the package is open source and all code is open to editing. The
two objects created as part of this vignette <code>simmr_in</code> and
<code>simmr_out</code> are R lists. They can be explored with e.g.</p>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">simmr_in</span><span class="op">)</span></span></code></pre></div>
<p>which will show their contents. The <code>simmr_out</code> object in
particular allows for full access to all of the posterior dietary
proportion samples. We can calculate for example the mean of the Zostera
dietary proportion on the first (or only) group:</p>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">simmr_out</span><span class="op">$</span><span class="va">output</span><span class="op">$</span><span class="va">`1`</span><span class="op">$</span><span class="va">BUGSoutput</span><span class="op">$</span><span class="va">sims.list</span><span class="op">$</span><span class="va">p</span><span class="op">[</span>, <span class="st">"Zostera"</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.2316519</span></span></code></pre>
<p>The backquotes around the 1 are required above because they specify
which group (the first). We can thus find the probability that the
posterior dietary proportion for Zostera is bigger than for Grass:</p>
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">simmr_out</span><span class="op">$</span><span class="va">output</span><span class="op">$</span><span class="va">`1`</span><span class="op">$</span><span class="va">BUGSoutput</span><span class="op">$</span><span class="va">sims.list</span><span class="op">$</span><span class="va">p</span><span class="op">[</span>, <span class="st">"Zostera"</span><span class="op">]</span></span>
<span><span class="op">&gt;</span> <span class="va">simmr_out</span><span class="op">$</span><span class="va">output</span><span class="op">$</span><span class="va">`1`</span><span class="op">$</span><span class="va">BUGSoutput</span><span class="op">$</span><span class="va">sims.list</span><span class="op">$</span><span class="va">p</span><span class="op">[</span>, <span class="st">"Grass"</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.3919444</span></span></code></pre>
<p>With more detailed R knowledge, it is possible to create scripts
which run multiple data sets in richer fashions than the default
<code>simmr</code> functions. See the help file
<code><a href="../reference/simmr_mcmc.html">help(simmr_mcmc)</a></code> for a full list of examples.</p>
</div>
<div class="section level2">
<h2 id="appendix---suggested-reading">Appendix - suggested reading<a class="anchor" aria-label="anchor" href="#appendix---suggested-reading"></a>
</h2>
<p>For the maths on the original SIAR model:<br>
Andrew C Parnell, Richard Inger, Stuart Bearhop, and Andrew L Jackson.
Source partitioning using stable isotopes: coping with too much
variation. PLoS ONE, 5(3):5, 2010.</p>
<p>For the geese data:<br>
Inger, R., Ruxton, G. D., Newton, J., Colhoun, K., Robinson, J. A.,
Jackson, A. L., &amp; Bearhop, S. (2006). Temporal and intrapopulation
variation in prey choice of wintering geese determined by stable isotope
analysis. Journal of Animal Ecology, 75, 1190–1200.</p>
<p>For the maths behind the more advanced JAGS models:<br>
Andrew C. Parnell, Donald L. Phillips, Stuart Bearhop, Brice X. Semmens,
Eric J. Ward, Jonathan W. Moore, Andrew L. Jackson, Jonathan Grey, David
J. Kelly, and Richard Inger. Bayesian stable isotope mixing models.
Environmetrics, 24(6):387–399, 2013.</p>
<p>For some good advice about mixing models:<br>
Donald L Phillips, Richard Inger, Stuart Bearhop, Andrew L Jackson,
Jonathan W Moore, Andrew C Parnell, Brice X Semmens, and Eric J Ward.
Best practices for use of stable isotope mixing models in food-web
studies. Canadian Journal of Zoology, 92(10):823–835, 2014.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Emma Govan, Andrew Parnell.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
